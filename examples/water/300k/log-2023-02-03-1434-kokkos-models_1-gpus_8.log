LAMMPS (3 Aug 2022)
KOKKOS mode is enabled (src/KOKKOS/kokkos.cpp:106)
  will use up to 8 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
Loaded 1 plugins from /blue/roitberg/apps/lammps-ani/build/
package kokkos
package kokkos gpu/aware on
# variables
variable       lammps_ani_root getenv LAMMPS_ANI_ROOT
# kokkos needs newton_pair on for reverse communication between gpus
variable       newton_pair     index  off
variable       num_models      index  1
variable       datafile        index  20k/water.data

# Intialization
units          real
atom_style     atomic

neighbor       2.0 bin
# check yes = only build if at least one atom has moved half the skin distance or more
neigh_modify   every 10 delay 0 check yes
newton         ${newton_pair} off
newton         on off

# Atom Definition
read_data      ${datafile}
read_data      300k/water.data
Reading data file ...
  triclinic box = (0 0 0) to (146.208 146.041 146.019) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  305484 atoms
  read_data CPU = 1.484 seconds
# replicate      3 3 3
change_box     all boundary p p p
Changing box ...

# pair_style ani 5.1 model_file device num_models ani_aev ani_neighbor
# 0. model_file               = path to the model file
# 1. device                   = cuda/cpu
# 2. num_models (Optional)    = number of models to use, default as -1 to use all models
# 3. ani_aev (Optional)       = cuaev/pyaev, default as cuaev
# 4. ani_neighbor (Optional)  = full/half, default as full nbrlist
# 5. ani_precision (Optional) = single/double, default as single
pair_style     ani 5.1 ${lammps_ani_root}/tests/ani2x.pt cuda ${num_models} cuaev full single
pair_style     ani 5.1 /blue/roitberg/apps/lammps-ani/tests/ani2x.pt cuda ${num_models} cuaev full single
pair_style     ani 5.1 /blue/roitberg/apps/lammps-ani/tests/ani2x.pt cuda 1 cuaev full single
pair_coeff     * *

# Settings: temperature at 300 K, timestep (0.5 fs)
velocity       all create 300.0 12345 rot yes mom yes dist gaussian
fix            1 all langevin 300.0 300.0 100.0 12345
fix            2 all nve
timestep       0.5

# Output: dump atom positions every 0.5 ps and log info every 0.5 ps
dump           1 all xyz 100 water.xyz
dump_modify    1 element H C N O F S Cl
thermo_style   custom step pe ke etotal temp press vol
thermo         100

# Run the simulation: first run (5 ps)
run            1000
Generated 0 of 21 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.1
  ghost atom cutoff = 7.1
  binsize = 7.1, bins = 21 21 21
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair ani/kk, perpetual
      attributes: full, newton on, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
Per MPI rank memory allocation (min/avg/max) = 15.84 | 15.9 | 15.95 Mbytes
   Step         PotEng         KinEng         TotEng          Temp          Press          Volume    
         0  -4.8824851e+09  273176.04     -4.8822119e+09  300            4005.1626      3117850.6    
       100  -4.8825178e+09  291503.82     -4.8822263e+09  320.12744      4273.8749      3117850.6    
       200  -4.882551e+09   299497.78     -4.8822515e+09  328.90635      4391.078       3117850.6    
       300  -4.8825755e+09  298012.23     -4.8822775e+09  327.27493      4369.2977      3117850.6    
       400  -4.8825939e+09  293755.76     -4.8823001e+09  322.60051      4306.8916      3117850.6    
       500  -4.8826103e+09  291219.25     -4.8823191e+09  319.81493      4269.7027      3117850.6    
       600  -4.8826236e+09  288403.64     -4.8823352e+09  316.72285      4228.4217      3117850.6    
       700  -4.8826352e+09  285670.38     -4.8823495e+09  313.7212       4188.348       3117850.6    
       800  -4.8826456e+09  284058.5      -4.8823616e+09  311.95104      4164.7154      3117850.6    
       900  -4.8826538e+09  281977.56     -4.8823718e+09  309.66577      4134.2059      3117850.6    
      1000  -4.8826608e+09  281230.03     -4.8823796e+09  308.84484      4123.246       3117850.6    
Loop time of 12.6182 on 8 procs for 1000 steps with 305484 atoms

Performance: 3.424 ns/day, 7.010 hours/ns, 79.251 timesteps/s
73.4% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.928     | 10.983     | 11.04      |   0.9 | 87.04
Neigh   | 0.023749   | 0.030708   | 0.041724   |   3.5 |  0.24
Comm    | 0.92132    | 0.98527    | 1.0264     |   3.0 |  7.81
Output  | 0.48556    | 0.48819    | 0.48946    |   0.2 |  3.87
Modify  | 0.0797     | 0.083851   | 0.089898   |   1.1 |  0.66
Other   |            | 0.04672    |            |       |  0.37

Nlocal:        38185.5 ave       38440 max       37972 min
Histogram: 1 0 1 2 2 0 0 1 0 1
Nghost:        26908.1 ave       27012 max       26816 min
Histogram: 2 1 0 2 0 0 0 1 0 2
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:  5.58031e+06 ave 5.64747e+06 max 5.52138e+06 min
Histogram: 1 0 0 2 3 0 0 1 0 1

Total # of neighbors = 44642466
Ave neighs/atom = 146.13684
Neighbor list builds = 28
Dangerous builds = 0

# write final state of simulation
# write_data    water.final
Total wall time: 0:00:19
