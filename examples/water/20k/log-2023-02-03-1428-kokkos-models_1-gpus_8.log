LAMMPS (3 Aug 2022)
KOKKOS mode is enabled (src/KOKKOS/kokkos.cpp:106)
  will use up to 8 GPU(s) per node
  using 1 OpenMP thread(s) per MPI task
Loaded 1 plugins from /blue/roitberg/apps/lammps-ani/build/
package kokkos
package kokkos gpu/aware on
# variables
variable       lammps_ani_root getenv LAMMPS_ANI_ROOT
# kokkos needs newton_pair on for reverse communication between gpus
variable       newton_pair     index  off
variable       num_models      index  1
variable       datafile        index  20k/water.data

# Intialization
units          real
atom_style     atomic

neighbor       2.0 bin
# check yes = only build if at least one atom has moved half the skin distance or more
neigh_modify   every 10 delay 0 check yes
newton         ${newton_pair} off
newton         on off

# Atom Definition
read_data      ${datafile}
read_data      20k/water.data
Reading data file ...
  triclinic box = (-30 -30 -30) to (30 30 30) with tilt (0 0 0)
  2 by 2 by 2 MPI processor grid
  reading atoms ...
  21384 atoms
  read_data CPU = 0.146 seconds
# replicate      3 3 3
change_box     all boundary p p p
Changing box ...

# pair_style ani 5.1 model_file device num_models ani_aev ani_neighbor
# 0. model_file               = path to the model file
# 1. device                   = cuda/cpu
# 2. num_models (Optional)    = number of models to use, default as -1 to use all models
# 3. ani_aev (Optional)       = cuaev/pyaev, default as cuaev
# 4. ani_neighbor (Optional)  = full/half, default as full nbrlist
# 5. ani_precision (Optional) = single/double, default as single
pair_style     ani 5.1 ${lammps_ani_root}/tests/ani2x.pt cuda ${num_models} cuaev full single
pair_style     ani 5.1 /blue/roitberg/apps/lammps-ani/tests/ani2x.pt cuda ${num_models} cuaev full single
pair_style     ani 5.1 /blue/roitberg/apps/lammps-ani/tests/ani2x.pt cuda 1 cuaev full single
pair_coeff     * *

# Settings: temperature at 300 K, timestep (0.5 fs)
velocity       all create 300.0 12345 rot yes mom yes dist gaussian
fix            1 all langevin 300.0 300.0 100.0 12345
fix            2 all nve
timestep       0.5

# Output: dump atom positions every 0.5 ps and log info every 0.5 ps
dump           1 all xyz 100 water.xyz
dump_modify    1 element H C N O F S Cl
thermo_style   custom step pe ke etotal temp press vol
thermo         100

# Run the simulation: first run (5 ps)
run            1000
Generated 0 of 21 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 10 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 7.1
  ghost atom cutoff = 7.1
  binsize = 7.1, bins = 9 9 9
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair ani/kk, perpetual
      attributes: full, newton on, kokkos_device
      pair build: full/bin/kk/device
      stencil: full/bin/3d
      bin: kk/device
Per MPI rank memory allocation (min/avg/max) = 3.37 | 3.37 | 3.37 Mbytes
   Step         PotEng         KinEng         TotEng          Temp          Press          Volume    
         0  -3.4177681e+08  19121.598     -3.4175769e+08  300            4046.7213      216000       
       100  -3.4177926e+08  20471.856     -3.4175878e+08  321.18427      4332.4774      216000       
       200  -3.4178122e+08  20838.167     -3.4176038e+08  326.93135      4410.0002      216000       
       300  -3.4178294e+08  20787.121     -3.4176216e+08  326.13049      4399.1974      216000       
       400  -3.4178415e+08  20515.071     -3.4176364e+08  321.86229      4341.6232      216000       
       500  -3.4178526e+08  20442.022     -3.4176481e+08  320.71622      4326.1638      216000       
       600  -3.4178619e+08  20137.995     -3.4176605e+08  315.94632      4261.8223      216000       
       700  -3.417868e+08   19863.822     -3.4176694e+08  311.6448       4203.7988      216000       
       800  -3.4178727e+08  19576.045     -3.4176769e+08  307.12985      4142.8963      216000       
       900  -3.4178805e+08  19683.396     -3.4176836e+08  308.81408      4165.615       216000       
      1000  -3.4178846e+08  19551.096     -3.417689e+08   306.73841      4137.6162      216000       
Loop time of 3.79072 on 8 procs for 1000 steps with 21384 atoms

Performance: 11.396 ns/day, 2.106 hours/ns, 263.802 timesteps/s
92.9% CPU use with 8 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.6448     | 2.7144     | 2.7693     |   2.6 | 71.61
Neigh   | 0.013033   | 0.016048   | 0.01979    |   1.8 |  0.42
Comm    | 0.86307    | 0.92373    | 0.99067    |   4.6 | 24.37
Output  | 0.03729    | 0.039434   | 0.040549   |   0.6 |  1.04
Modify  | 0.070497   | 0.073267   | 0.076247   |   0.7 |  1.93
Other   |            | 0.0238     |            |       |  0.63

Nlocal:           2673 ave        2694 max        2655 min
Histogram: 2 1 1 1 0 0 0 0 1 2
Nghost:        5903.62 ave        5962 max        5864 min
Histogram: 2 1 1 1 0 0 1 0 1 1
Neighs:              0 ave           0 max           0 min
Histogram: 8 0 0 0 0 0 0 0 0 0
FullNghs:       394252 ave      399595 max      390328 min
Histogram: 2 0 1 1 1 1 1 0 0 1

Total # of neighbors = 3154014
Ave neighs/atom = 147.49411
Neighbor list builds = 24
Dangerous builds = 0

# write final state of simulation
# write_data    water.final
Total wall time: 0:00:08
